!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="269ca351-3b4e-4dc3-8c63-9a454b4ee97d",e._sentryDebugIdIdentifier="sentry-dbid-269ca351-3b4e-4dc3-8c63-9a454b4ee97d")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5740],{34329:(e,t,r)=>{r.d(t,{Rz:()=>s,vT:()=>i,w5:()=>u});var a=r(65980),n=r(2467);async function i(e){let{orderId:t,...r}=e,{user:n}=await (0,a.Ay)(`order/thank-you-page/${t}`,(0,a.tS)(r));return{user:n}}async function s(e){let{orderId:t}=e;try{let{lifeTimeValue:e}=await (0,a.Ay)(`life-time-value/${t}`);return e||(0,n.Cp)(new n.tr,{name:"userData",data:{orderId:t,apiResponse:JSON.stringify({lifeTimeValue:e}),fetchStatusCode:200,fetchStatusText:""}},{id:t}),e||0}catch(e){return(0,n.Cp)(new n.tr,{name:"userData",data:{orderId:t,apiResponse:JSON.stringify(e?.data||{}),fetchStatusCode:e?.response?.status||"",fetchStatusText:e?.response?.statusText||"",errorSource:JSON.stringify(e||{})}},{id:t}),0}}async function u(e){let{orderId:t}=e;try{let{lifeTimeValue:e}=await (0,a.Ay)(`life-time-value/split-purchase/${t}`);return e||(0,n.Cp)(new n.tr,{name:"userData",data:{orderId:t,apiResponse:JSON.stringify({lifeTimeValue:e}),fetchStatusCode:200,fetchStatusText:""}},{id:t}),e||0}catch(e){return(0,n.Cp)(new n.tr,{name:"userData",data:{orderId:t,apiResponse:JSON.stringify(e?.data||{}),fetchStatusCode:e?.response?.status||"",fetchStatusText:e?.response?.statusText||"",errorSource:JSON.stringify(e||{})}},{id:t}),0}}},74930:(e,t,r)=>{async function a(e,t){let r=await fetch("/api/mgmt/splits",{method:t?"POST":"PUT",body:JSON.stringify(e)}),a=await r.json();if(r.ok)return a;throw a}async function n(e,t){let r=await fetch("/api/mgmt/redirects",{method:t?"POST":"PUT",body:JSON.stringify(e)}),a=await r.json();if(r.ok)return a;throw a}r.d(t,{FG:()=>a,RF:()=>n}),r(65980),r(2467),r(55036)},53500:(e,t,r)=>{r.d(t,{PJ:()=>l,Xu:()=>p,cK:()=>d,eW:()=>c,ik:()=>o,kg:()=>s,tV:()=>u});var a=r(20578),n=r(65980),i=r(84646);async function s(e){let{profile:t,...r}=e,{userId:a}=await (0,n.Ay)("user/create",{method:"POST",data:t,...(0,n.tS)(r)});return a}async function u(e){let{userId:t,pricePackage:r,type:a}=e;if(t&&r)try{await (0,n.Ay)("user-price-package/create",{method:"POST",data:{userId:t,pricePackage:r,type:a},headers:{"Content-Type":"application/json"}})}catch{}}function o(e){let{href:t,cookie:r,locale:n,user:s,splitConfigList:u,userAgent:o,splitStepsChain:c}=e,l={locale:n,href:t,cookie:r,price_package:s?.pricing.pricePackageSlug,quiz_page:s?.templates.quizPage,final_page:s?.templates.finalPage,upsell_page:s?.templates.upsellPage,thank_you_page:s?.templates.thankYouPage,age:s?.profile.age,os:(0,i.rT)(o)},d={...s};try{let e=(0,a.tQ)({splitConfigList:u.filter(e=>e.enabled),context:l,splitSteps:{all:["step_one","step_final","step_purchase"],current:c}});return e.result?.config&&(d.templates={...d.templates,finalPage:e.result.instruction?.final_page||l.final_page,thankYouPage:e.result.instruction?.thank_you_page||l.thank_you_page,upsellPage:e.result.instruction?.upsell_page||l.upsell_page},d.pricing={...d.pricing,pricePackageSlug:e.result.instruction?.price_package||l.price_package}),{user:d,unsplittedUser:s,split:e,splitConfigList:u}}catch(e){return console.log("get splitted user error",{user:s}),console.error(e),{user:d,unsplittedUser:s,splitConfigList:u}}}async function c(e){let{userId:t,...r}=e;return(0,n.Ay)(`user/final-page/${t}`,(0,n.tS)(r))}async function l(e){let{userId:t,utm:r}=e;(0,n.Ay)("user/visited-checkout",{method:"POST",data:{userId:t,utm:r}})}async function d(e){let{userId:t,utm:r}=e;try{return await (0,n.Ay)("user/visited-thank-you",{method:"POST",data:{userId:t,utm:r}}),!0}catch{return!1}}async function p(e){let{templateType:t,templateIdentifier:r,templateDescription:a}=e;try{return await (0,n.Ay)("user/template",{method:"POST",headers:{"Content-Type":"application/json"},data:{templateType:t,templateIdentifier:r,templateDescription:a}}),!0}catch{return!1}}r(74930)},5740:(e,t,r)=>{r.d(t,{Bv:()=>h,LD:()=>S,R:()=>_,Ug:()=>k,VE:()=>m,VM:()=>P,YA:()=>f,ZX:()=>g,Zw:()=>d,aT:()=>y,f0:()=>w,fW:()=>b,iq:()=>T,nw:()=>p,y8:()=>R});var a=r(10126),n=r(98511),i=r(36942),s=r(34329),u=r(53500),o=r(57958),c=r(55036);let l=new a.Q({serviceURL:"https://analytic-info-collector.unimealplan.com/api/v1/",authToken:"bWFtQ0YzX0NbWWVtSSUsMzg6cHdrUEZkcXR6anV6dUpiSldKc1c="});function d(){return(0,n._)("userSplits")||[]}function p(e,t){if(c.env.NEXT_PUBLIC_TEST_ENV&&console.log("test env",c.env.NEXT_PUBLIC_TEST_ENV),l){let r=(0,o.P)();l.logEvent(e,{...t,exp:d(),country:(0,i.Ri)("countryCode"),proxyUserId:(0,i.Ri)("proxy_user_id"),utm:{campaign:r.utm.utmCampaign,medium:r.utm.utmMedium,source:r.utm.utmSource},host:window.location.hostname,project:"harna",platforms:{facebook:{fbc:(0,i.Ri)("_fbc"),fbp:(0,i.Ri)("_fbp")},google:{gclid:(0,i.Ri)("gclid"),gbraid:(0,i.Ri)("gbraid"),wbraid:(0,i.Ri)("wbraid")},twitter:{twclid:(0,i.Ri)("twclid")},yahoo:{vmcid:(0,i.Ri)("vmcid")},snapchat:{clickId:(0,i.Ri)("ScCid"),uuidC1:(0,i.Ri)("_scid")},tiktok:{clickId:(0,i.Ri)("ttclid")}}})}}function m(e){if(window.amplitude){let t=new window.amplitude.Identify;Object.keys(e).forEach(r=>{t.set(r,e[r])}),window.amplitude.identify(t)}else console.error("amplitudeSetUserProps: amplitude sdk load error")}function f(e){let{productId:t,price:r,revenue:a}=e;if(window.amplitude){let e=new window.amplitude.Revenue().setProductId(`product_${t||"UNDEFINED_ID"}_${r||"UNDEFINED_PRICE"}`).setPrice(r||0).setRevenue(a).setQuantity(1);window.amplitude.revenue(e)}else console.error("amplitudeRevenue: amplitude sdk load error")}let w="942386919558774,325738298610492,1747227552077627".split(",").filter(e=>!!e);function h(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];window.fbq?window.fbq(...t):console.error("facebook pixel sdk load error")}function _(e,t){window.dataLayer||console.warn("GTM sdk not loaded"),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:e,...t})}function g(e,t){window.ttq?window.ttq[e](...t):console.error("Tiktok sdk load error")}function y(){let e=(0,i.Ri)("fbclid"),t=(0,i.Ri)("custom_fbc")||(e?`fb.1.${Date.now()}.${e}`:"");return(0,i.TV)("custom_fbc",t),{fbc:(0,i.Ri)("_fbc")||(0,i.Ri)("custom_fbc")||null,fbp:(0,i.Ri)("_fbp")||null}}function S(){return{gclid:(0,i.Ri)("gclid")||null,gbraid:(0,i.Ri)("gbraid")||null,wbraid:(0,i.Ri)("wbraid")||null}}function b(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];window.snaptr&&window.snaptr(...t)}function k(){return{uuidC1:(0,i.Ri)("_scid")||null,clickId:(0,i.Ri)("ScCid")||null}}function v(){return i.Ri("camp_name")?.includes("three_events")}function R(e,t){window.amplitude?window.amplitude.track(e,{...t,url:window.location.href,...y(),...S()}):console.error("amplitudeLogEvent: amplitude sdk load error")}async function T(e){let{upsellOrderId:t,upsellType:r,userEmail:a}=e,n=v(),i=await (0,s.w5)({orderId:t});n&&(R(`three_events_${r}_upsell_purchased`,{upsellLTV:i,upsellOrderId:t}),R("three_events_upsell_purchased",{upsellLTV:i,upsellOrderId:t}),window.userEmail=a,h("track","Purchase",{value:i,currency:"USD",content_type:"product",content_ids:[`upsell_${t}`]},{eventID:t})),_("upsell_checkout_success",{upsellType:r,upsellOrderId:t,upsellLTV:i})}async function P(e){let{orderId:t,userId:r,userEmail:a,funnelName:n,productId:i,amount:c,paymentMethod:l}=e,d=v(),m=(0,o.P)()||{},[y,S]=await Promise.all([(0,s.Rz)({orderId:t}),(0,s.w5)({orderId:t}),(0,u.cK)({userId:r,utm:m.utm||{}})]);window.ltv=y,window.splittedLtv=S,window.orderId=t,window.userEmail=a,R("checkout_success",{payment_method:l}),_("checkoutSuccess"),w.forEach(e=>{h("trackSingle",e,"Purchase",{value:d?S:y,currency:"USD"},{eventID:t})}),g("identify",[{email:a}]),b("track","PURCHASE",{price:y,currency:"USD",transaction_id:t,client_deduplication_id:t,user_email:a}),g("track",["CompletePayment",{event_id:t,currency:"USD",value:y,content_id:i}]),p("purchase",{funnelName:n,userId:r}),R("purchase"),f({productId:i,price:+c||0,revenue:y})}},57958:(e,t,r)=>{r.d(t,{P:()=>o});var a=r(36942),n=r(43015),i=r(98511),s=r(84646);let u=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","camp_id","camp_name","asn","locale","pp","click_id","proxy_user_id","ftm","ttm","st","expName_start","expGrp_start","tmr","fbclid","ScCid","utm_target","gclid","gbraid","wbraid","twclid","vmcid","ttclid"];function o(){let e=(0,a.Ri)("proxy_user_id")||(0,n.yk)();(0,a.TV)("proxy_user_id",e,{expires:365});let t=new URLSearchParams(window.location.search),r=t.get("utm_source"),o=t.get("utm_campaign"),c=r&&r!==(0,a.Ri)("utm_source"),l=o&&o!==(0,a.Ri)("utm_campaign");(c||l)&&u.forEach(e=>{(0,a.zs)(e)});let d=(0,i._)("userProperties")||{},p=u.reduce((e,r)=>{let n=t.get(r)||(0,a.Ri)(r)||d.campaignRawParams?.[r];return n&&((0,a.TV)(r,n,{expires:365}),e[r]=n||null),e},{domain_name:"https://pilates.harnafit.com/",isCrawler:(0,s.vn)(navigator.userAgent)}),m={utmSource:p.utm_source,utmCampaign:p.utm_campaign,utmTerm:p.utm_term,utmMedium:p.utm_medium,utmContent:p.utm_content,asn:p.asn,campId:p.camp_id,campName:p.camp_name,locale:p.locale};return(0,i.A)("userProperties",{campaignRawParams:p,campaignUTMParams:m}),{raw:p,utm:m}}},84646:(e,t,r)=>{r.d(t,{rT:()=>i,vn:()=>s});var a=r(30601),n=r(89242);function i(e){let{name:t=""}=new a.O(e).getOS();return t}function s(e){let t=new a.O(e).getResult();return t.ua.includes("bot")||t.ua.includes("crawl")||t.ua.includes("spider")||(0,n.w2)(t.ua)||(0,n.OM)(t.ua)}},65980:(e,t,r)=>{r.d(t,{Ay:()=>u,al:()=>i,tS:()=>n});var a=r(2467);function n(e){let{headers:t,token:r,locale:a,rawHeaders:n}=e,i={...r?{Authorization:`Bearer ${r}`}:{},...a?{"Accept-Language":a}:{},...n};if(t){let e=t?.get("x-forwarded-for"),r=t?.get("host");e&&(i["X-Forwarded-For"]=e),r&&(i["origin-host"]=r)}return{headers:i}}async function i(e){try{return await e.json()}catch{return null}}async function s(e){try{return await e.text()}catch{return null}}let u=async function(e,t){let{data:r,...n}=t||{},u=await fetch(`${e.startsWith("https://")?"":"https://api-web.harna.app/api/v1/"}${e}`,{...n,...r?{body:JSON.stringify(r)}:{},..."patch"===n.method?{method:"PATCH"}:{},headers:{...e.startsWith("https://")&&!e.startsWith("https://api-web.harna.app/api/v1/")?{}:{Authorization:"Bearer n6qjWrbjwqjs9DDxuzCuTJ0AHR5pKh8X8JEr4IZM0Ufg5aMzK8"},...n?.headers||{}}}),o=await i(u);if(!u.ok){console.log({endpoint:e,responseData:o,status:u.status,text:u.statusText});let t=await s(u);throw new a.xF(u,e,o,t)}return o}},2467:(e,t,r)=>{r.d(t,{Cp:()=>c,bV:()=>s,jJ:()=>n,tr:()=>u,xF:()=>o,zF:()=>i});var a=r(81832);class n extends Error{constructor(e){super(`[🔴 dynamicUpsells FE]: ${e}`),this.name="DynamicUpsellTemplateError"}}class i extends Error{constructor(){super("CreateProfileValidationError"),this.name="CreateProfileValidationError"}}class s extends Error{constructor(){super("CreateProfileAPIInernalError"),this.name="CreateProfileAPIInernalError"}}class u extends Error{constructor(){super("getLTVError"),this.name="getLTVError"}}class o extends Error{constructor(e,t,r,a){super(e.statusText),this.name="CallApiError",this.reqUrl=t,this.response=e,this.data=r||{},this.text=a||""}}function c(e,t,r){return t&&(r&&a.gV(r),a.o(t.name,t.data)),a.Cp(e)}}}]);